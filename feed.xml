<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://isaac-flath.github.io/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://isaac-flath.github.io/blog/" rel="alternate" type="text/html" /><updated>2020-05-17T21:13:52-05:00</updated><id>https://isaac-flath.github.io/blog/feed.xml</id><title type="html">Isaac’s Blog</title><subtitle>A place for Isaac to write blog posts on things that interest him or those that he talks to.</subtitle><entry><title type="html">Column Space and Null Space (18.06_L7)</title><link href="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/16/18.06_7_pivot_variables_special_solutions.html" rel="alternate" type="text/html" title="Column Space and Null Space (18.06_L7)" /><published>2020-05-16T00:00:00-05:00</published><updated>2020-05-16T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/linear%20algebra/2020/05/16/18.06_7_pivot_variables_special_solutions</id><content type="html" xml:base="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/16/18.06_7_pivot_variables_special_solutions.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-16-18.06_7_pivot_variables_special_solutions.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Ax=0&quot;&gt;Ax=0&lt;a class=&quot;anchor-link&quot; href=&quot;#Ax=0&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;$A =$ $\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
2&amp;amp;4&amp;amp;6&amp;amp;8\\
3&amp;amp;6&amp;amp;8&amp;amp;10
\end{bmatrix}$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;You may notice not all rows and columns are independent
&lt;/div&gt;
Let's do elimination to start solving.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
2&amp;amp;4&amp;amp;6&amp;amp;8\\
3&amp;amp;6&amp;amp;8&amp;amp;10
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;2&amp;amp;4\\
0&amp;amp;0&amp;amp;2&amp;amp;4
\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Uh oh.  Now I see a 0 in the pivot position &lt;strong&gt;and&lt;/strong&gt; I cannot do a row exchange.  Really that's just telling me that the now is just a combination of earlier columns.  It's depending on earlier columns.  Let's just go on and use the next column as the pivot for that row.&lt;/p&gt;
&lt;p&gt;$A=$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
2&amp;amp;4&amp;amp;6&amp;amp;8\\
3&amp;amp;6&amp;amp;8&amp;amp;10
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;2&amp;amp;4\\
0&amp;amp;0&amp;amp;2&amp;amp;4
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;2&amp;amp;4\\
0&amp;amp;0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=U$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;We have 2 pivots (aka rank 2).  Row 1, Column 1 and Row 2, Column 3.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Special-Solutions.&quot;&gt;Special Solutions.&lt;a class=&quot;anchor-link&quot; href=&quot;#Special-Solutions.&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let's write out $U$ in matrix in equation form to see what we have.&lt;/p&gt;
&lt;p&gt;$x_1+2x_2+2x_3+2x_4=0$&lt;/p&gt;
&lt;p&gt;$2x_3+4x_4=0$&lt;/p&gt;
&lt;p&gt;Let's call the columns with a pivot a pivot column, and ones without a free column.  So we have 2 pivot columns and 2 free columns.&lt;/p&gt;
&lt;p&gt;Let's assign some values to the free columns, then solve for the pivot columns using back substitution.  We'll call these special solutions.&lt;/p&gt;
&lt;p&gt;$x=$
$\begin{bmatrix}
\\
1\\
\\
0
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
-2\\
1\\
0\\
0
\end{bmatrix}$
$=&amp;gt;$
$C$$\begin{bmatrix}
-2\\
1\\
0\\
0
\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Let's put 1 in the other free variable.&lt;/p&gt;
&lt;p&gt;$x=$
$\begin{bmatrix}
\\
0\\
\\
1
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
2\\
0\\
-2\\
1
\end{bmatrix}$
$=&amp;gt;$
$C$$\begin{bmatrix}
2\\
0\\
-2\\
1
\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Great.  Our entire nullspace is a linear combination of these 2 special solutions.  There will be 1 special solution for each free variable.  In this case there were 2 (free columns, rank, free variables, etc).&lt;/p&gt;
&lt;p&gt;$C$$\begin{bmatrix}
-2\\
1\\
0\\
0
\end{bmatrix}$
$+$
$d$$\begin{bmatrix}
2\\
0\\
-2\\
1
\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Reduced-Row-Echelon-Form-($R$)&quot;&gt;Reduced Row Echelon Form ($R$)&lt;a class=&quot;anchor-link&quot; href=&quot;#Reduced-Row-Echelon-Form-($R$)&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Reduced row echelon form has zeros above and below pivots, and the pivots are = 1.  Let's do this using elimination.&lt;/p&gt;
&lt;p&gt;$U=$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;2&amp;amp;4\\
0&amp;amp;0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;0&amp;amp;-2\\
0&amp;amp;0&amp;amp;2&amp;amp;4\\
0&amp;amp;0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;0&amp;amp;-2\\
0&amp;amp;0&amp;amp;1&amp;amp;2\\
0&amp;amp;0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=R$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;This row of 0&amp;#8217;s was created because elimination identified that row 3 is just a combination of rows 1 and 2.
&lt;/div&gt;
Why this form?&lt;/p&gt;
&lt;p&gt;We see in the pivot columns we see $I$  $\begin{bmatrix}1&amp;amp;0\\0&amp;amp;1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;In the free columns we see the opposite of the nullspace definintions we found above $\begin{bmatrix}2&amp;amp;-2\\0&amp;amp;2\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Solve-the-transpose&quot;&gt;Solve the transpose&lt;a class=&quot;anchor-link&quot; href=&quot;#Solve-the-transpose&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;$A=$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;3\\
2&amp;amp;4&amp;amp;6\\
2&amp;amp;6&amp;amp;8\\
2&amp;amp;8&amp;amp;10
\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Elimination-from-$A$--&amp;gt;-$U$&quot;&gt;Elimination from $A$ -&amp;gt; $U$&lt;a class=&quot;anchor-link&quot; href=&quot;#Elimination-from-$A$--&amp;gt;-$U$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$\begin{bmatrix}
1&amp;amp;2&amp;amp;3\\
2&amp;amp;4&amp;amp;6\\
2&amp;amp;6&amp;amp;8\\
2&amp;amp;8&amp;amp;10
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;3\\
0&amp;amp;0&amp;amp;0\\
0&amp;amp;2&amp;amp;2\\
0&amp;amp;4&amp;amp;4
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;2&amp;amp;3\\
0&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;0\\
0&amp;amp;0&amp;amp;0
\end{bmatrix}$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;Notice that I did a row exchange to do this elimination and ended with a rank 2, which was the same as with the transpose.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Solve-for-Nullspace&quot;&gt;Solve for Nullspace&lt;a class=&quot;anchor-link&quot; href=&quot;#Solve-for-Nullspace&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;There's 1 free column, so you fill in a 1 in the free column.
$x=$$\begin{bmatrix}\\\\1\end{bmatrix}$
Then with back substution solve for the pivot columns.  The solution is any linear combination of this, which is a line in the null space.&lt;/p&gt;
&lt;p&gt;
$$x=C\begin{bmatrix}-1\\-1\\1\end{bmatrix}$$
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Row-Reduction-from-$U$--&amp;gt;-$R$&quot;&gt;Row Reduction from $U$ -&amp;gt; $R$&lt;a class=&quot;anchor-link&quot; href=&quot;#Row-Reduction-from-$U$--&amp;gt;-$R$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Row Echelon Form&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}
1&amp;amp;2&amp;amp;3\\
0&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;0\\
0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;0&amp;amp;1\\
0&amp;amp;2&amp;amp;2\\
0&amp;amp;0&amp;amp;0\\
0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=&amp;gt;$
$\begin{bmatrix}
1&amp;amp;0&amp;amp;1\\
0&amp;amp;1&amp;amp;1\\
0&amp;amp;0&amp;amp;0\\
0&amp;amp;0&amp;amp;0
\end{bmatrix}$
$=R$&lt;/p&gt;
&lt;p&gt;We see the identity matrix in the pivot columns, and the opposite of our pivot nullspace varibales in the free column.  Perfect!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Column Space and Null Space (18.06_L6)</title><link href="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/16/18.06_6_ColumnSpace_Nullspace.html" rel="alternate" type="text/html" title="Column Space and Null Space (18.06_L6)" /><published>2020-05-16T00:00:00-05:00</published><updated>2020-05-16T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/linear%20algebra/2020/05/16/18.06_6_ColumnSpace_Nullspace</id><content type="html" xml:base="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/16/18.06_6_ColumnSpace_Nullspace.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-16-18.06_6_ColumnSpace_Nullspace.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Background&quot;&gt;Background&lt;a class=&quot;anchor-link&quot; href=&quot;#Background&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We started on this topic in the last post, so much this section is review - but critical for the upcoming discussion.&lt;/p&gt;
&lt;h2 id=&quot;Vector-Spaces&quot;&gt;Vector Spaces&lt;a class=&quot;anchor-link&quot; href=&quot;#Vector-Spaces&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;To have a vector space you need to be able to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Add any vectors and still be within the space&lt;/li&gt;
&lt;li&gt;Multiply by any number and stay within space&lt;/li&gt;
&lt;li&gt;Take any linear combination and stay within space&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Examples&quot;&gt;Examples&lt;a class=&quot;anchor-link&quot; href=&quot;#Examples&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$R^2$ is a vector space.  This is all real number vectors with 2 components.  Here's a few examples.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}3\\2\end{bmatrix}$,
$\begin{bmatrix}0\\0\end{bmatrix}$,
$\begin{bmatrix}\pi\\e\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$R^3$ is another vector space, but it contains all real 3D vectors.  Here's a few examples.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}3\\2\\5\end{bmatrix}$,
$\begin{bmatrix}3\\2\\0\end{bmatrix}$,
$\begin{bmatrix}0\\0\\0\end{bmatrix}$,
$\begin{bmatrix}\pi\\e\\5\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$R^n$ is another with all column vectors with $n$ real components.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Subspaces&quot;&gt;Subspaces&lt;a class=&quot;anchor-link&quot; href=&quot;#Subspaces&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;What if we just want a piece of $R^n$?  We still need to be able to add vectors and multiply it together.  So what are some subspaces?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A line through $R^n$ that goes through the origin.  Any multiple of a point on a line is still on the line.  We need the origin because you can mutliply any vector by 0, which would give you the origin.&lt;/li&gt;
&lt;li&gt;Just the Origin is a subspace.  You can add it to itelf, multiply it by anything, and take any combination and you will stil lhave the origin.&lt;/li&gt;
&lt;li&gt;In $R^3$ and above, a plane through the origin is also a subspace.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Combinations-of-Subspaces&quot;&gt;Combinations of Subspaces&lt;a class=&quot;anchor-link&quot; href=&quot;#Combinations-of-Subspaces&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;If I have 2 subspaces, then all vectors in P or L or both does not make a subspace.  I can't add all together.  In $R^3$ I would have to make a cube which would be all of $R^3$.&lt;/p&gt;
&lt;p&gt;However, if you all points that are in both subspaces does make a subspace it is a subspace.  If you think about it, by definition 2 Vectors in the intersection are for the subspace 1 and they are both in subspace 2.  We already know that if you add 2 vectors in subspace 1 you get another vector in subspace 1.  We also know the same thing about subspace 2.  So really, any linear combination has to be in both subspaces (probably a smaller subspace).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Subspace-from-a-matrix&quot;&gt;Subspace from a matrix&lt;a class=&quot;anchor-link&quot; href=&quot;#Subspace-from-a-matrix&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;Column-Space&quot;&gt;Column Space&lt;a class=&quot;anchor-link&quot; href=&quot;#Column-Space&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$\begin{bmatrix}1&amp;amp;1&amp;amp;2\\2&amp;amp;1&amp;amp;3\\3&amp;amp;1&amp;amp;4\\4&amp;amp;1&amp;amp;5\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Columns are in $R^4$ and all their linear combinations are a subspace.  So we have 3 subspaces, 1 for each column.  So the full subspace for this matrix must have a linear combination of all columns, or all 3 subspaces.  With 3 columns do we get all of $R^4$? What exactly do we get?  How big is this subspace?  Does $Ax=b$ have a solution for every $b$?  Which $b$ values are ok?&lt;/p&gt;
&lt;p&gt;We know it doesn't, because we have 4 equations but only 3 unknowns.  In the proper form we see.&lt;/p&gt;
&lt;p&gt;$Ax=b$
$\begin{bmatrix}1&amp;amp;1&amp;amp;2\\2&amp;amp;1&amp;amp;3\\3&amp;amp;1&amp;amp;4\\4&amp;amp;1&amp;amp;5\end{bmatrix}$
$\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}$
$=$
$\begin{bmatrix}b_1\\b_2\\b_3\\b_4\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Now, just because we can't solve for every b doesn't mean we can't solve it for any b.  So which $b$'s allow this to be solved?  Obviously we can solve for the 0 vector.  Obviously we can solve for (1,2,3,4) or any other column as we can have $x_1 = 1$ with the other x's being 0.  We could also solve for multiples of any column because $x_2$ could equal 2 or 3 with other uknowns being 0.
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;To Summarize, Ax=b can be solved with $b$ is in $C(A)$, the column space of A.
&lt;/div&gt;
Now column 3 and column 1 are redundant, so we can throw away column 3.  Column 1 + column 2 = column 3.  So really linear combinations of the first 2 columns gives the same subspace as linear combinations of all 3 columns.  So in all practicality, we have 2 equations with 4 unknowns with 2 of the columns sitting on the same plane.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Nullspace&quot;&gt;Nullspace&lt;a class=&quot;anchor-link&quot; href=&quot;#Nullspace&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$\begin{bmatrix}1&amp;amp;1&amp;amp;2\\2&amp;amp;1&amp;amp;3\\3&amp;amp;1&amp;amp;4\\4&amp;amp;1&amp;amp;5\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Nullspace of $A$ = all solutions of $x$ where $Ax=0$.  Because there are 3 unknowns, it's a subspace in $R^3$.  This is opposed to the column space that is in $R^4$.  Naturally the 0 vector always satisfies this so is always in the nullspace.  Here's a few others&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}0\\0\\0\end{bmatrix}$,
$\begin{bmatrix}1\\1\\-1\end{bmatrix}$,
$\begin{bmatrix}2\\2\\-2\end{bmatrix}$,
$\begin{bmatrix}-1\\-1\\1\end{bmatrix}$,
$\begin{bmatrix}-2\\-2\\2\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;To summarize, we really have a line in $R^3$, which is a subspace:
$c\begin{bmatrix}1\\1\\-1\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Solution-Spaces&quot;&gt;Solution Spaces&lt;a class=&quot;anchor-link&quot; href=&quot;#Solution-Spaces&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Great!  So we have defined the nullspace, which is just a subspace when $b$ is the 0 vector.  Why not do the same thing with other $b$'s?  For example:&lt;/p&gt;
&lt;p&gt;$Ax=b$
$\begin{bmatrix}1&amp;amp;1&amp;amp;2\\2&amp;amp;1&amp;amp;3\\3&amp;amp;1&amp;amp;4\\4&amp;amp;1&amp;amp;5\end{bmatrix}$
$\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}$
$=$
$\begin{bmatrix}1\\2\\3\\4\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Clearly it isn't a space because the zero vector is not a solution.&lt;/p&gt;
&lt;p&gt;Possible Solutions = 
$\begin{bmatrix}1\\0\\0\end{bmatrix}$,
$\begin{bmatrix}2\\1\\-1\end{bmatrix}$,
$\begin{bmatrix}3\\2\\-2\end{bmatrix}$,
$\begin{bmatrix}0\\-1\\1\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Transposes, Permutations, and Spaces (18.06_L5)</title><link href="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/13/18.06_5_Transposes,Permutations,Spaces.html" rel="alternate" type="text/html" title="Transposes, Permutations, and Spaces (18.06_L5)" /><published>2020-05-13T00:00:00-05:00</published><updated>2020-05-13T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/linear%20algebra/2020/05/13/18.06_5_Transposes,Permutations,Spaces</id><content type="html" xml:base="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/13/18.06_5_Transposes,Permutations,Spaces.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-13-18.06_5_Transposes,Permutations,Spaces.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Background&quot;&gt;Background&lt;a class=&quot;anchor-link&quot; href=&quot;#Background&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In previous posts, we have gone over elimination to solve systems of equations.  However, every example workout out perfectly.  What I mean by that is we didn't have to do row exchanges.  Every example was in an order that worked on attempt 1.  In this post, we are going to talk about how to solve equations when this isn't the case.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Row-Exchanges&quot;&gt;Row Exchanges&lt;a class=&quot;anchor-link&quot; href=&quot;#Row-Exchanges&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The way we do a row exchange in matrix language is that we multiply by a permutation matrix, which we will refer to as $P$.&lt;/p&gt;
&lt;p&gt;So how do we account for row exchanges?  Our previous equation of $A=LU$ does not account for row exchanges.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Permutations&quot;&gt;Permutations&lt;a class=&quot;anchor-link&quot; href=&quot;#Permutations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A Permutation matrix executes our row exhanges.  This matrix $P$ is the identify matrix with reording rows. $A=LU$ becomes $PA=LU$.  We multipy a permutation matrix $P$ by $A$.
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;The reason we were able to ignore $P$ in previous posts is because when you have no row exchanges, $P$ is just the identify matrix (no re-ordering)
&lt;/div&gt;
If we were to switch rows 2 and 3 in a 3x3 matrix, $P$ would be&lt;/p&gt;
&lt;p&gt;
$$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\0&amp;amp;0&amp;amp;1\\0&amp;amp;1&amp;amp;0\end{bmatrix}$$
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Transposed-Matrices&quot;&gt;Transposed Matrices&lt;a class=&quot;anchor-link&quot; href=&quot;#Transposed-Matrices&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;A transposed matrix has rows and columns switched.  Naturally, symmetric matrices are unchanged by the transpose.&lt;/p&gt;
&lt;p&gt;A Matrix multiplied by it's transpose always gives a symmetric matrix.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Vector-Spaces&quot;&gt;Vector Spaces&lt;a class=&quot;anchor-link&quot; href=&quot;#Vector-Spaces&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;To have a vector space you need to be able to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Add any vectors and still be within the space&lt;/li&gt;
&lt;li&gt;Multiply by any number and stay within space&lt;/li&gt;
&lt;li&gt;Take any linear combination and stay within space&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Examples&quot;&gt;Examples&lt;a class=&quot;anchor-link&quot; href=&quot;#Examples&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$R^2$ is a vector space.  This is all real number vectors with 2 components.  Here's a few examples.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}3\\2\end{bmatrix}$,
$\begin{bmatrix}0\\0\end{bmatrix}$,
$\begin{bmatrix}\pi\\e\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$R^3$ is another vector space, but it contains all real 3D vectors.  Here's a few examples.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}3\\2\\5\end{bmatrix}$,
$\begin{bmatrix}3\\2\\0\end{bmatrix}$,
$\begin{bmatrix}0\\0\\0\end{bmatrix}$,
$\begin{bmatrix}\pi\\e\\5\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$R^n$ is another with all column vectors with $n$ real components.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Subspaces&quot;&gt;Subspaces&lt;a class=&quot;anchor-link&quot; href=&quot;#Subspaces&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;What if we just want a piece of $R^n$?  We still need to be able to add vectors and multiply it together.  So what are some subspaces?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A line through $R^n$ that goes through the origin.  Any multiple of a point on a line is still on the line.  We need the origin because you can mutliply any vector by 0, which would give you the origin.&lt;/li&gt;
&lt;li&gt;Just the Origin is a subspace.  You can add it to itelf, multiply it by anything, and take any combination and you will stil lhave the origin.&lt;/li&gt;
&lt;li&gt;In $R^3$ and above, a plane through the origin is also a subspace.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Subpace-from-a-matrix&quot;&gt;Subpace from a matrix&lt;a class=&quot;anchor-link&quot; href=&quot;#Subpace-from-a-matrix&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;3\\4&amp;amp;1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Columns in $R^3$ and all their linear combinations are a subspace.  This subspace is a plane going through the origin&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Predictive Customer Analytics (Part 2)</title><link href="https://isaac-flath.github.io/blog/customer%20analytics/2020/05/12/Customer-Analytics-Part-2.html" rel="alternate" type="text/html" title="Predictive Customer Analytics (Part 2)" /><published>2020-05-12T00:00:00-05:00</published><updated>2020-05-12T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/customer%20analytics/2020/05/12/Customer-Analytics-Part-2</id><content type="html" xml:base="https://isaac-flath.github.io/blog/customer%20analytics/2020/05/12/Customer-Analytics-Part-2.html">&lt;h1 id=&quot;intro&quot;&gt;Intro&lt;/h1&gt;

&lt;p&gt;Customer Analytics is a valuable tool, but often the basics are overlooked. It can have a huge impact, and it doesn’t always mean complex modeling.  It always starts with the basics.&lt;/p&gt;

&lt;p&gt;This is the 2nd post in a series about customer analytics.  The first post discusses descriptive analytics and how to create and use descriptive customer analytics.  In this post we will be building on that descriptive framework to create a very basic predictive model.  A predictive model allows companies to plan proactively instead of reactively.&lt;/p&gt;

&lt;h1 id=&quot;background&quot;&gt;Background&lt;/h1&gt;

&lt;p&gt;In the first post we created three descriptive metrics (Recency, Frequency, and Average Monetary Value).  Recency is days since the last purchase.  Frequency is the number of cycles that the customer purchased product in.  Monetary Value is the average revenue brought in from that customer in cycles where the customer purchased product.  How can you determine the predicted customer value and take action based on that information?&lt;/p&gt;

&lt;p&gt;We need to group customers based on how they behave.  This allows us to quickly and efficiently test different actions and see how that affects our long term revenue projections.  A customer who  makes many small purchases may be just as valuable as a customer who places huge orders infrequently, but they should be handled differently.  RFM is one tool we can use to group customers together.&lt;/p&gt;

&lt;h1 id=&quot;normalize-the-metrics&quot;&gt;Normalize the metrics&lt;/h1&gt;

&lt;p&gt;We start with a basic table with three companies and their 3 KPIs.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;Recency (days since previous purchase)&lt;/th&gt;
      &lt;th&gt;Frequency (number of months with purchases)&lt;/th&gt;
      &lt;th&gt;Monetary Value (avg monthly revenue during months with purchases)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer A&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;$79&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer B&lt;/td&gt;
      &lt;td&gt;35&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;$91&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer C&lt;/td&gt;
      &lt;td&gt;48&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;$9852&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Now that we have values for each of these three metrics (Recency, Frequency, and Monetary Value), we need to put them into a format where we can easily compare the customers.  This is called normalizing the data.  Normalization puts all the metrics on a scale of 0 (lowest) to 1 (highest).   Here is a formula for normalizing:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;(&amp;lt;Value you want to normalize&amp;gt; – &amp;lt;Minimum Value in series&amp;gt;) / (&amp;lt;Maximum value in series&amp;gt; – &amp;lt;Minimum value in series&amp;gt;)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Let’s walk through normalizing the Recency KPI.  Based on the formula above we need a couple of pieces of information.  Let’s identify these now.&lt;/p&gt;

&lt;p&gt;Minimum Value in series = 3
Maximum value in series = 48&lt;/p&gt;

&lt;p&gt;Now let’s plug in the formula for each customer to normalize the values.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;Recency&lt;/th&gt;
      &lt;th&gt;Normalized Recency&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer A&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;=(3-3) / (48-3) = 0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer B&lt;/td&gt;
      &lt;td&gt;35&lt;/td&gt;
      &lt;td&gt;=(35-3) / (48-3) = 0.711&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer C&lt;/td&gt;
      &lt;td&gt;48&lt;/td&gt;
      &lt;td&gt;=(48-3) / (48-3) = 1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;The next step is to repeat this process for the other metrics.  I won’t walk through the other two, but here are the accurate values if you’d like to test yourself.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;Recency&lt;/th&gt;
      &lt;th&gt;Frequency&lt;/th&gt;
      &lt;th&gt;Monetary Value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer A&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer B&lt;/td&gt;
      &lt;td&gt;0.711&lt;/td&gt;
      &lt;td&gt;0.5&lt;/td&gt;
      &lt;td&gt;0.001&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer C&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;A low recency score is good.  A high Frequency or Monetary Value Score is good.  If you’d like to simplify it so you don’t have to remember that feel free to take your normalized recency score and subtract it from 1.  That will make low scores bad and high scores good on all metrics.&lt;/p&gt;

&lt;h1 id=&quot;group-the-customers-together&quot;&gt;Group the customers together&lt;/h1&gt;

&lt;p&gt;Now that we have normalized our KPIs, we need to group our customers together.  In the table above we only have 3 customers, so there would be no point in grouping them together.  In a more practical example we may have 1000 customers, 10,000 customers, or more.  When we have that many customers, we can greatly simplify things by grouping like customers together.&lt;/p&gt;

&lt;p&gt;We can group customers using our RFM KPIs, but there may be more information we want to pull into that decision.  For example if we are a manufacturing company that sells product to end users as well as distributors we may want to take that into account.  A distributor is likely to behave and react differently from an individual person.  For example, an individual person may get a coupon in the mail and decide to purchase, but a distributor contact may get hundreds of coupons a week and just get annoyed.&lt;/p&gt;

&lt;p&gt;A lot of time should be spent exploring different ways to break up customers.  Explaining how you break up the customers into groups to sales people, product management, purchasing, production control, and other functional groups in your company can be a great way to get ideas.  Each of these groups sees how customers react in different ways and talking to all of them can help give a more complete picture.&lt;/p&gt;

&lt;h1 id=&quot;create-probability-matrix&quot;&gt;Create probability matrix&lt;/h1&gt;

&lt;p&gt;The goal of customer analytics is to predict how much money we are going to make next month, and the month after, and the month after that, and so on.  Once we can predict that with reasonable accuracy we can determine exactly how much revenue we can expect from each customer if we do not change anything.&lt;/p&gt;

&lt;p&gt;We need to put probabilities on customer actions.  In simplest terms the customer has 2 choices during each cycle, buy or do not buy.  So how do we figure out what the chance of that is for a group?&lt;/p&gt;

&lt;p&gt;Suppose we a group of distributors we sell to that we believe act similarly as with the table below.  A 1 means that the distributor bought something in that cycle, a 0 means that the distributor did not buy anything in that cycle.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;January&lt;/th&gt;
      &lt;th&gt;February&lt;/th&gt;
      &lt;th&gt;March&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Distributor A&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Distributor B&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Distributor C&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Since there are 9 total opportunities to buy, and 4 of those have buys in them, we will assign a 4/9 chance of buying.  Really this is just another way to measure frequency.&lt;/p&gt;

&lt;p&gt;Now we know how many of the customers in the distributor group will buy in a given month (4 out of 9), so we need to turn that into a revenue figure.  To do this we will take the sum of revenue from these customers and divide that by the number of buys.  Here we are calculating Monetary Value (M), but instead of looking at it on a customer level, we are looking at it for a group of customers.&lt;/p&gt;

&lt;p&gt;Once we multiply those two numbers together we have an estimated monthly revenue.&lt;/p&gt;

&lt;p&gt;There’s several areas for future improvement that I won’t cover in this post.  Depending on the market or the business model your company uses, they will vary in significance.  Here’s a few of them:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Take into account recency.&lt;/li&gt;
  &lt;li&gt;Take into account customer retention.  This makes forecasts accuracy go down farther out you go into the future.  Since for this application we aren’t looking out very far in the future it makes less of a difference, but it is definitely high priority on our list of future enhancements.&lt;/li&gt;
  &lt;li&gt;Changes in buy patterns based on seasonal trends.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;increase-revenue-using-predicted-value-of-each-account&quot;&gt;Increase revenue using predicted value of each account&lt;/h1&gt;

&lt;p&gt;Now that we know roughly what revenue we can expect, we can use that for a variety of things.  Here’s a few ideas:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;First, we can look at which locations/territories are performing as forcasted.  Once we know the high performing locations and the low performing locations, we can start to identify what the differences are. This can also be used to manage performance of employees, set meaningful incentives based on revenue, and set measurable objectives.&lt;/li&gt;
  &lt;li&gt;We can continue to do A/B testing, but be able to tie this to actual revenue dollars.&lt;/li&gt;
  &lt;li&gt;We can use these forecasts to determine inventory stances on either components or salable goods.&lt;/li&gt;
  &lt;li&gt;Now that we have grouped customers that behave similarly, we can start to determine how we should treat each group.  We can have limited A/B testing.  Instead of taking a random group of customers, we can take a random group of distributors to see how they specifically react.&lt;/li&gt;
  &lt;li&gt;We can determine who our most valuable customers are.  Typically without measures, we remember the big purchases.  But a regular purchaser that doesn’t make big purchases may be bringing us more revenue.  Understanding which customers are most likely to be the most profitable is crucial and can help us determine pricing tiers for customers or determine customer loyalty programs.&lt;/li&gt;
  &lt;li&gt;We can identify low performing groups and create a strategy to get more penetration into those customers.  Maybe for those customers we can send them surveys.  Maybe we can set up a forum and do 6 month surveys where we work and collaborate with them regularly.  This can help give insight into why they don’t purchase much, as well as be a good sales opportunity.  We can also try to take action to take the low performing customers and get them to increase revenue through promotions or other incentives.&lt;/li&gt;
  &lt;li&gt;We can take the high performing customers and make sure that they know they are appreciated.  Whether it’s a can of cashews over the holidays, or having a sales person reach out to talk once a month, building that relationship can really build customer loyalty.&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Intro</summary></entry><entry><title type="html">Factorization into $A=LU$ (18.06_L4)</title><link href="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/12/18.06_4_Factorization-into-a-lu.html" rel="alternate" type="text/html" title="Factorization into $A=LU$ (18.06_L4)" /><published>2020-05-12T00:00:00-05:00</published><updated>2020-05-12T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/linear%20algebra/2020/05/12/18.06_4_Factorization-into-a-lu</id><content type="html" xml:base="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/12/18.06_4_Factorization-into-a-lu.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-12-18.06_4_Factorization into a-lu.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Inverse-of-$AB$,-$A^T$&quot;&gt;Inverse of $AB$, $A^T$&lt;a class=&quot;anchor-link&quot; href=&quot;#Inverse-of-$AB$,-$A^T$&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Review&quot;&gt;Review&lt;a class=&quot;anchor-link&quot; href=&quot;#Review&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;So we know from previous lectures/blog posts that $A$ time the inverse of $A$ gives the Identify Matrix $I$.  The Identify matrix is matrix equivilent to multiplying by 1, no change to the matrix.&lt;/p&gt;
&lt;p&gt;$AA^{-1}=I=A^{-1}A$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;AB-Inverse&quot;&gt;AB Inverse&lt;a class=&quot;anchor-link&quot; href=&quot;#AB-Inverse&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;So if the Inverse of a Matrix time it's inverse gives the identity, how do we find the inverse of a product of matrices?  It turns out you just multiply the inverses of those matrices in reverse.&lt;/p&gt;
&lt;p&gt;Why in reverse?  If you put socks and shoes on, you wouldn't invert that process by taking socks off first.  You would invert it by doing the steps in reverse.  Shoes off first.&lt;/p&gt;
&lt;p&gt;A more technical understanding of this can be seen below:&lt;/p&gt;
&lt;p&gt;$ABB^{-1}A^{-1}= I$&lt;/p&gt;
&lt;p&gt;Let's multiply the middle piece first.  $BB^{-1}$  We know that equals the Identify matrix, and a matrix time the identity just gives that matrix.  So then what you are left wtih is $AA^{-1}=I$, which we also know is true.&lt;/p&gt;
&lt;p&gt;This work the other way as well:&lt;/p&gt;
&lt;p&gt;$B^{-1}(A^{-1}A)B = I$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;$A^T$&quot;&gt;$A^T$&lt;a class=&quot;anchor-link&quot; href=&quot;#$A^T$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Transposes work in a similar way.  We can tak transposes in reverse to get the Identity Matrix.&lt;/p&gt;
&lt;p&gt;$AA^{-1}=I$&lt;/p&gt;
&lt;p&gt;$(A^{-1})^TA^T=I$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Converting-to-$A-=-LU$&quot;&gt;Converting to $A = LU$&lt;a class=&quot;anchor-link&quot; href=&quot;#Converting-to-$A-=-LU$&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;2x2-to-$A=LU$&quot;&gt;2x2 to $A=LU$&lt;a class=&quot;anchor-link&quot; href=&quot;#2x2-to-$A=LU$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Previously we learned that using Elimination we create these Elimination Matrices.  In this example of a 2x2 matrix:&lt;/p&gt;
&lt;p&gt;$E_{21}A = U =&amp;gt; $
$\left[
\begin{array}{cc}
1 &amp;amp; 0 \\
-4 &amp;amp; 1 \\
\end{array}
\right]$
$\left[
\begin{array}{cc}
2 &amp;amp; 1 \\
8 &amp;amp; 7 \\
\end{array}
\right]$
$=$
$\left[
\begin{array}{cc}
2 &amp;amp; 1 \\
0 &amp;amp; 3 \\
\end{array}
\right]$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now how do we get $A=LU$ from this.  We can see matrix $A$ and matrix $U$ are already in the right place, so lets leave those alone.  We can see that we need to turn Matrix $E_{21}$ into Matrix $L$ by switching it's sides.  The way we move a matrix from one side to the other is through the inverse of the matrix.&lt;/p&gt;
&lt;p&gt;$A=LU=&amp;gt;$
$\left[
\begin{array}{cc}
2 &amp;amp; 1 \\
8 &amp;amp; 7 \\
\end{array}
\right]$
$=$
$\left[
\begin{array}{cc}
1 &amp;amp; 0 \\
4 &amp;amp; 1 \\
\end{array}
\right]$
$\left[
\begin{array}{cc}
2 &amp;amp; 1 \\
0 &amp;amp; 3 \\
\end{array}
\right]$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;$E_{21}A = U$ is just a different format of  $A=LU$.  In $A=LU$ you can see $L$ is just $E_{21}^{-1}$
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;3x3-to-$A-=-LU$&quot;&gt;3x3 to $A = LU$&lt;a class=&quot;anchor-link&quot; href=&quot;#3x3-to-$A-=-LU$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As we saw in an earlier blog, when we do elimination of a 3x3 matrix we would get more Elmination matrices.  We are still working examples with no row exchanges.&lt;/p&gt;
&lt;p&gt;
$$E_{32}E_{31}E_{21}A=U$$
&lt;/p&gt;
&lt;p&gt;So how do we convert this into $A = LU$?  As we learned above, we can invert the product of matrices as well.  Let's apply that here with these matrices.&lt;/p&gt;
&lt;p&gt;
$$A=E_{21}^{-1}E_{31}^{-1}E_{32}^{-1}U$$
&lt;/p&gt;
&lt;p&gt;Well that doesn't look as nice to work with as $A = LU$.  So let's just simplify it by multiplying all the Elimination inverse matrices together.  Meaning L would be a product of these 3 inverse matrices.&lt;/p&gt;
&lt;p&gt;
$$A=E^{-1}U=LU$$
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;$A=LU$-vs-$EA=U$&quot;&gt;$A=LU$ vs $EA=U$&lt;a class=&quot;anchor-link&quot; href=&quot;#$A=LU$-vs-$EA=U$&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;What's the point of taking the inverse.  It's the same formula mathamatrically, so why bother with this transformation.  Why $E^{-1}$ on the right and not just stay with $E$ on the left?  Let's do an example.&lt;/p&gt;
&lt;p&gt;$E_{32}E_{21}=E =&amp;gt;$
$\left[
\begin{array}{ccc}
1 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; -5 &amp;amp; 1
\end{array}
\right]$
$\left[
\begin{array}{ccc}
1 &amp;amp; 0 &amp;amp; 0 \\
-2 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 0 &amp;amp; 1
\end{array}
\right]$
$=$
$\left[
\begin{array}{ccc}
1 &amp;amp; 0 &amp;amp; 0 \\
-2 &amp;amp; 1 &amp;amp; 0 \\
10 &amp;amp; -5 &amp;amp; 1
\end{array}
\right]$&lt;/p&gt;
&lt;p&gt;$E_{21}^{-1}E_{32}^{-1}=E^{-1} =&amp;gt;$
$\left[
\begin{array}{ccc}
1 &amp;amp; 0 &amp;amp; 0 \\
2 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 0 &amp;amp; 1
\end{array}
\right]$
$\left[
\begin{array}{ccc}
1 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 5 &amp;amp; 1
\end{array}
\right]$
$=$
$\left[
\begin{array}{ccc}
1 &amp;amp; 0 &amp;amp; 0 \\
2 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 5 &amp;amp; 1
\end{array}
\right]$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;2 and 5 were the multipliers that we used in our elinimation steps.
&lt;/div&gt;
We can see that with $E^{-1}$ has 2 and 5 in the matrix. So if there are no row exchanges L is just a record of what the multipliers were, which is very convenient.  Worded another way, with no row exchanges the multipliers go directly into L.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Multiplication and Inverse Matrices (18.06_L3)</title><link href="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/11/18.06_3_Multiplication-and-Inverse-Matrices.html" rel="alternate" type="text/html" title="Multiplication and Inverse Matrices (18.06_L3)" /><published>2020-05-11T00:00:00-05:00</published><updated>2020-05-11T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/linear%20algebra/2020/05/11/18.06_3_Multiplication-and-Inverse-Matrices</id><content type="html" xml:base="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/11/18.06_3_Multiplication-and-Inverse-Matrices.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-11-18.06_3_Multiplication and Inverse Matrices.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Matrix-Multiplication&quot;&gt;Matrix Multiplication&lt;a class=&quot;anchor-link&quot; href=&quot;#Matrix-Multiplication&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Rules&quot;&gt;Rules&lt;a class=&quot;anchor-link&quot; href=&quot;#Rules&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A matrix is laid out by row and column.  Menaing, a particular cell in matrix $C$ is $C_{ij}$.  For example, $C_{34}$ is the 3rd row, 4th column in matrix $C$.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}
1,1&amp;amp;1,2&amp;amp;1,3&amp;amp;1,4\\
2,1&amp;amp;2,2&amp;amp;2,3&amp;amp;2,4\\
3,1&amp;amp;3,2&amp;amp;3,3&amp;amp;3,4\\
4,1&amp;amp;4,2&amp;amp;4,3&amp;amp;4,4
\end{bmatrix}$&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Number of columns in matrix A must match number of rows in matrix B.&lt;/li&gt;
&lt;li&gt;The output of matrix multiplication will be dimensions equal to the number of rows in matrix A by the number of columns in matrix B.&lt;/li&gt;
&lt;li&gt;You can cut the matrix into blocks and do matrix multiplication in blocks.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;$\begin{bmatrix}A_1&amp;amp;A_2\\A_3&amp;amp;A_4\end{bmatrix}
\begin{bmatrix}B_1&amp;amp;B_2\\B_3&amp;amp;B_4\end{bmatrix}=
\begin{bmatrix}A_1B_1+A_2B_3&amp;amp;A_1B_2+A_2B_4\\A_3B_1+A_4B_3&amp;amp;A_3B_2+A_4B_4\end{bmatrix}$
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;While cutting it into blocks may not seem useful immediately, it is crucial for high speed computation. In Deep Learning where you are multiplying large matrices together can speed up computation speed immensely by breaking them into blocks so you can fit the blocks into CPU Memory.  In fact, this is exactly what pytorch does.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;1st-Way&quot;&gt;1st Way&lt;a class=&quot;anchor-link&quot; href=&quot;#1st-Way&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let's imagine we have a matrix multiplation&lt;/p&gt;
&lt;p&gt;
$$AB=C$$
&lt;/p&gt;
&lt;p&gt;$C_{34}=$(row 3 of A)$\cdot$(column 4 of B)&lt;/p&gt;
&lt;p&gt;$C_{34}=a_{31}b_{14}+a_{32}b_{24}+......$&lt;/p&gt;
&lt;p&gt;$C_{34}=\sum\limits_{k=1}^n a_{3k}b_{k4}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;2nd-Way&quot;&gt;2nd Way&lt;a class=&quot;anchor-link&quot; href=&quot;#2nd-Way&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;
$$AB=C$$
&lt;/p&gt;
&lt;p&gt;The second way to think about it is that matrix $A$ times by the first column of matrix $B$ will give you the first column of $C$.&lt;/p&gt;
&lt;p&gt;Matrix $A$ times by the second column of matrix $B$ will give you the second column of $C$.&lt;/p&gt;
&lt;p&gt;Now really what we are doing is thinking of columns of $C$ as combinations of columns of $A$&lt;/p&gt;
&lt;p&gt;$A \cdot B_{n1} =C_{m1}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;3rd-Way&quot;&gt;3rd Way&lt;a class=&quot;anchor-link&quot; href=&quot;#3rd-Way&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;
$$AB=C$$
&lt;/p&gt;
&lt;p&gt;The third way to think about it is that a row of $A$ times matrix $B$ will give you a column of $C$.&lt;/p&gt;
&lt;p&gt;Now really what we are doing is thinking of rows of $C$ as combinations of rows of $B$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;4th-Way&quot;&gt;4th Way&lt;a class=&quot;anchor-link&quot; href=&quot;#4th-Way&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;If we multiply a column by a row, we get a full sized matrix.  We also see that the columns are multiples of the column, and the rows and multiples of the row.  This is what we expect as we just discussed above with the combinations of each other.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}2\\3\\4\end{bmatrix}\begin{bmatrix}1&amp;amp;6\end{bmatrix}=\begin{bmatrix}2&amp;amp;12\\3&amp;amp;18\\4&amp;amp;24\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;$AB=$Sum of (Cols of A) $\cdot$ (Rows of B)&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}2&amp;amp;7\\3&amp;amp;8\\4&amp;amp;9\end{bmatrix}\begin{bmatrix}1&amp;amp;6\\0&amp;amp;0\end{bmatrix}$
$=$
$\begin{bmatrix}2\\3\\4\end{bmatrix}\begin{bmatrix}1&amp;amp;6\end{bmatrix}+$
$\begin{bmatrix}7\\8\\9\end{bmatrix}\begin{bmatrix}0&amp;amp;0\end{bmatrix}$
$=$
$\begin{bmatrix}2&amp;amp;12\\3&amp;amp;18\\4&amp;amp;24\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;This matrix all sit on the same line because they are just multiples.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Inverses&quot;&gt;Inverses&lt;a class=&quot;anchor-link&quot; href=&quot;#Inverses&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Not all Matrices have inverses.  Most important question is whether it's invertable.  If $A^-1$ exists.&lt;/p&gt;
&lt;p&gt;$A^{-1}A = I = AA^{-1}$&lt;/p&gt;
&lt;p&gt;Invertable, nonsingular are the good case.&lt;/p&gt;
&lt;h2 id=&quot;Matrices-with-no-inverse&quot;&gt;Matrices with no inverse&lt;a class=&quot;anchor-link&quot; href=&quot;#Matrices-with-no-inverse&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the singular case there is no inverse.  2x2 matrix that has no inverse.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;6\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Cannot get 1,0, because I can find a vector $x$ with $Ax=0$&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;6\end{bmatrix}\begin{bmatrix}3\\-1\end{bmatrix}=\begin{bmatrix}0\\0\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;But why does this matter?  Because if I use these values for X anything I multiply by cannot possibly give the identify matrix, because 0 times anything gives 0.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Matrices-with-an-inverse&quot;&gt;Matrices with an inverse&lt;a class=&quot;anchor-link&quot; href=&quot;#Matrices-with-an-inverse&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$AA^{-1}=I =&amp;gt; 
\begin{bmatrix}1&amp;amp;3\\2&amp;amp;7\end{bmatrix}
\begin{bmatrix}a&amp;amp;b\\c&amp;amp;d\end{bmatrix}=
\begin{bmatrix}1&amp;amp;0\\0&amp;amp;1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Now from our matrix multiplication work above we know that
$A \cdot$column $j$ of $A^{-1} = $column $j$ of $I$&lt;/p&gt;
&lt;p&gt;So we really have a system of 2 equations to solve.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;7\end{bmatrix}\begin{bmatrix}a\\c\end{bmatrix}=\begin{bmatrix}1\\0\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;7\end{bmatrix}\begin{bmatrix}b\\d\end{bmatrix}=\begin{bmatrix}0\\1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;So we are back to solving systems of equations.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Gauss-Jordan-/-Find-$A^{-1}$&quot;&gt;Gauss-Jordan / Find $A^{-1}$&lt;a class=&quot;anchor-link&quot; href=&quot;#Gauss-Jordan-/-Find-$A^{-1}$&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Solve 2 equations at once&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;7\end{bmatrix}\begin{bmatrix}a\\b\end{bmatrix}=\begin{bmatrix}1\\0\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;3\\2&amp;amp;7\end{bmatrix}\begin{bmatrix}c\\d\end{bmatrix}=\begin{bmatrix}0\\1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;The gauss-Jordan Method solved both equations at once by created an augmented matrix.&lt;/p&gt;
&lt;p&gt;We will now do elimination steps to get the identify on the left.  This will convert A to A inverse.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Start with $AI$&lt;/li&gt;
&lt;li&gt;Elimination step subtracting 2 of the first row from the second row&lt;/li&gt;
&lt;li&gt;Elinination step subtracting 3 of the second row from the first.&lt;/li&gt;
&lt;li&gt;End with $IA^{-1}$&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;$
\left[
\begin{array}{cc|cc}
1 &amp;amp; 3 &amp;amp; 1 &amp;amp; 0 \\
2 &amp;amp; 7 &amp;amp; 0 &amp;amp; 1 \\
\end{array}
\right]
=&amp;gt;
\left[
\begin{array}{cc|cc}
1 &amp;amp; 3 &amp;amp; 1 &amp;amp; 0 \\
0 &amp;amp; 1 &amp;amp; -2 &amp;amp; 1 \\
\end{array}
\right]
=&amp;gt;
\left[
\begin{array}{cc|cc}
1 &amp;amp; 0 &amp;amp; 7 &amp;amp; -3 \\
0 &amp;amp; 1 &amp;amp; -2 &amp;amp; 1 \\
\end{array}
\right]
$&lt;/p&gt;
&lt;p&gt;Naturally we get the inverse because we really reverse the sides of the equation.  Just like in algebra if you have -5 on one side, you can move it by putting the inverse on the other side (+5).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Random Forest Classifier</title><link href="https://isaac-flath.github.io/blog/tree%20ensembles/2020/05/11/RandomForestClassifier.html" rel="alternate" type="text/html" title="Random Forest Classifier" /><published>2020-05-11T00:00:00-05:00</published><updated>2020-05-11T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/tree%20ensembles/2020/05/11/RandomForestClassifier</id><content type="html" xml:base="https://isaac-flath.github.io/blog/tree%20ensembles/2020/05/11/RandomForestClassifier.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-11-RandomForestClassifier.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Goal&quot;&gt;Goal&lt;a class=&quot;anchor-link&quot; href=&quot;#Goal&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The goal is to predict whether a passenger on the Titanic survived or not.  The applications for binary classification are endless and could be applied to many real world problems.  Does this patient have this disease?  Will this customer Churn?  Will price go up?  These are just a few examples.&lt;/p&gt;
&lt;p&gt;The purpose is to give a general guide to classification.  If you get through this and want more detail, I highly recommend checking out the Tabular Chapter of Deep Learning for Coders with fastai &amp;amp; Pytorch by Jeremy Howard and Sylvain Gugger.  The book primarily focuses on deep learning, though decision trees are covered for tabular data.  All of the material in this guide and more is covered in much greater detail in that book.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527&quot;&gt;https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Setup&quot;&gt;Setup&lt;a class=&quot;anchor-link&quot; href=&quot;#Setup&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We are going to start with loading libraries and datasets that are needed.  I am going to skip over this as they are pretty self explanatory, but feel free to look close if you would like.&lt;/p&gt;
&lt;p&gt;I am going to use Seaborn to load the Titanic dataset.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.ensemble&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sns&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fastai2.tabular.all&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fastai2&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;dtreeviz.trees&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.cluster&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hierarchy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;titanic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;survived&lt;/th&gt;
      &lt;th&gt;pclass&lt;/th&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;age&lt;/th&gt;
      &lt;th&gt;sibsp&lt;/th&gt;
      &lt;th&gt;parch&lt;/th&gt;
      &lt;th&gt;fare&lt;/th&gt;
      &lt;th&gt;embarked&lt;/th&gt;
      &lt;th&gt;class&lt;/th&gt;
      &lt;th&gt;who&lt;/th&gt;
      &lt;th&gt;adult_male&lt;/th&gt;
      &lt;th&gt;deck&lt;/th&gt;
      &lt;th&gt;embark_town&lt;/th&gt;
      &lt;th&gt;alive&lt;/th&gt;
      &lt;th&gt;alone&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;male&lt;/td&gt;
      &lt;td&gt;22.0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;7.2500&lt;/td&gt;
      &lt;td&gt;S&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;man&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Southampton&lt;/td&gt;
      &lt;td&gt;no&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;female&lt;/td&gt;
      &lt;td&gt;38.0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;71.2833&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;woman&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Cherbourg&lt;/td&gt;
      &lt;td&gt;yes&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;female&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;7.9250&lt;/td&gt;
      &lt;td&gt;S&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;woman&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Southampton&lt;/td&gt;
      &lt;td&gt;yes&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;female&lt;/td&gt;
      &lt;td&gt;35.0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;53.1000&lt;/td&gt;
      &lt;td&gt;S&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;woman&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Southampton&lt;/td&gt;
      &lt;td&gt;yes&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;male&lt;/td&gt;
      &lt;td&gt;35.0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;8.0500&lt;/td&gt;
      &lt;td&gt;S&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;man&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Southampton&lt;/td&gt;
      &lt;td&gt;no&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Data-Setup&quot;&gt;Data Setup&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-Setup&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Dependent-Variable&quot;&gt;Dependent Variable&lt;a class=&quot;anchor-link&quot; href=&quot;#Dependent-Variable&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We want to define what we are predicting, or the dependent variable.  We also see that 'Survived' and 'alive' columns are the same thing with different names.  We need to get rid of one and predict the other.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# survived is a duplicate of alive, so get rid of it&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;survived&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;alive&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training-and-Validation-Set-Split&quot;&gt;Training and Validation Set Split&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-and-Validation-Set-Split&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Best practice is to minimally have a training and validation set.  Those are the 2 that we will use for this tutorial.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Training Set:  This is what the model actually trains on&lt;/li&gt;
&lt;li&gt;Validation Set:  This is used to gauge success of the Training&lt;/li&gt;
&lt;li&gt;Test Set:  This is a held out of the total process to be an additional safeguard against overfitting&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cond&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cond&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cond&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Dates&quot;&gt;Dates&lt;a class=&quot;anchor-link&quot; href=&quot;#Dates&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We don't have any dates to deal with, but if we did we would do the following:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;df = add_datepart(df,'date')&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This would replace that date with a ton of different columns, such as the year, the day number, the day of the week, is it month end, is it month start, and more.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Categorical-Variables&quot;&gt;Categorical Variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Categorical-Variables&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h5 id=&quot;Ordinal-Categorical-Variables&quot;&gt;Ordinal Categorical Variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Ordinal-Categorical-Variables&quot;&gt; &lt;/a&gt;&lt;/h5&gt;&lt;p&gt;Some categorical variables have a natural heirarchy.  By telling pandas the order it tends to mean trees don't have to split as many times, which speeds up training times.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[Third, First, Second]
Categories (3, object): [Third, First, Second]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;First&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Second&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Third&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_categories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ordered&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h5 id=&quot;Categorical-Variables-Final&quot;&gt;Categorical Variables Final&lt;a class=&quot;anchor-link&quot; href=&quot;#Categorical-Variables-Final&quot;&gt; &lt;/a&gt;&lt;/h5&gt;&lt;p&gt;We are now going to do some data cleaning.  The Categorify and FillMissing functions in the fastai2 library make this easy.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;procs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Categorify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FillMissing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cont_cat_split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TabularPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;procs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's take a look at the training and validation sets and make sure we have a good split of each.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(691, 200)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can now take a look and see that while we see all the same data, behind the scenes it is all numeric.  This is exactly what we need for our random forest.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;embarked&lt;/th&gt;
      &lt;th&gt;class&lt;/th&gt;
      &lt;th&gt;who&lt;/th&gt;
      &lt;th&gt;adult_male&lt;/th&gt;
      &lt;th&gt;deck&lt;/th&gt;
      &lt;th&gt;embark_town&lt;/th&gt;
      &lt;th&gt;alone&lt;/th&gt;
      &lt;th&gt;age_na&lt;/th&gt;
      &lt;th&gt;pclass&lt;/th&gt;
      &lt;th&gt;age&lt;/th&gt;
      &lt;th&gt;sibsp&lt;/th&gt;
      &lt;th&gt;parch&lt;/th&gt;
      &lt;th&gt;fare&lt;/th&gt;
      &lt;th&gt;alive&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;female&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;woman&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Cherbourg&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;38.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;71.283302&lt;/td&gt;
      &lt;td&gt;yes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;female&lt;/td&gt;
      &lt;td&gt;S&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;woman&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;#na#&lt;/td&gt;
      &lt;td&gt;Southampton&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;7.925000&lt;/td&gt;
      &lt;td&gt;yes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;male&lt;/td&gt;
      &lt;td&gt;S&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;man&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;#na#&lt;/td&gt;
      &lt;td&gt;Southampton&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;35.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;8.050000&lt;/td&gt;
      &lt;td&gt;no&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;pclass&lt;/th&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;age&lt;/th&gt;
      &lt;th&gt;sibsp&lt;/th&gt;
      &lt;th&gt;parch&lt;/th&gt;
      &lt;th&gt;fare&lt;/th&gt;
      &lt;th&gt;embarked&lt;/th&gt;
      &lt;th&gt;class&lt;/th&gt;
      &lt;th&gt;who&lt;/th&gt;
      &lt;th&gt;adult_male&lt;/th&gt;
      &lt;th&gt;deck&lt;/th&gt;
      &lt;th&gt;embark_town&lt;/th&gt;
      &lt;th&gt;alive&lt;/th&gt;
      &lt;th&gt;alone&lt;/th&gt;
      &lt;th&gt;age_na&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;38.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;71.283302&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;7.925000&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;35.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;8.050000&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Final-Change&quot;&gt;Final Change&lt;a class=&quot;anchor-link&quot; href=&quot;#Final-Change&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Finally, we will put just the data in xs and ys so they are in easy format to pass to models.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Random-Forest-Model&quot;&gt;Random Forest Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Random-Forest-Model&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h3 id=&quot;Initial-Model&quot;&gt;Initial Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Initial-Model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Let's start by creating a model without tuning and see how it does&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_estimators&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[433,   1],
       [  8, 249]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Looking pretty good!  Only 7 wrong.  Let's see how it did on the validation set.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[105,  10],
       [ 23,  62]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Still way better than 50/50, but not quite as good.  This is because the model did not train based on this validation data so it doesn't perform nearly as well.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Model-Tuning---Grid-Search&quot;&gt;Model Tuning - Grid Search&lt;a class=&quot;anchor-link&quot; href=&quot;#Model-Tuning---Grid-Search&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We made our first model, and it doesn't seem to predict as well as we would like.  Let's do something about that.&lt;/p&gt;
&lt;p&gt;We are going to do a grid search.  There are many more sophisticated ways to find parameters (maybe a future post), but the grid search is easy to understand.  Basically you pick some ranges, and you try them all to see what works best.&lt;/p&gt;
&lt;p&gt;We will use the built in gridsearch.  All we need to do is define the range of parameters, and let it find the best model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;n_estimators&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
              &lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
              &lt;span class=&quot;s1&quot;&gt;&amp;#39;min_samples_split&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
              &lt;span class=&quot;s1&quot;&gt;&amp;#39;max_features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;log2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]}&lt;/span&gt;             
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_jobs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/home/isaacflath/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py:1978: FutureWarning: The default value of cv will change from 3 to 5 in version 0.22. Specify it explicitly to silence this warning.
  warnings.warn(CV_WARNING, FutureWarning)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;GridSearchCV(cv=&amp;#39;warn&amp;#39;, error_score=&amp;#39;raise-deprecating&amp;#39;,
             estimator=RandomForestClassifier(bootstrap=True, class_weight=None,
                                              criterion=&amp;#39;gini&amp;#39;, max_depth=None,
                                              max_features=&amp;#39;auto&amp;#39;,
                                              max_leaf_nodes=None,
                                              min_impurity_decrease=0.0,
                                              min_impurity_split=None,
                                              min_samples_leaf=1,
                                              min_samples_split=2,
                                              min_weight_fraction_leaf=0.0,
                                              n_estimators=&amp;#39;warn&amp;#39;, n_jobs=None,
                                              oob_score=False,
                                              random_state=None, verbose=0,
                                              warm_start=False),
             iid=&amp;#39;warn&amp;#39;, n_jobs=-1,
             param_grid={&amp;#39;max_depth&amp;#39;: range(10, 20, 20),
                         &amp;#39;max_features&amp;#39;: [&amp;#39;auto&amp;#39;, &amp;#39;log2&amp;#39;],
                         &amp;#39;min_samples_split&amp;#39;: range(2, 20),
                         &amp;#39;n_estimators&amp;#39;: range(10, 20, 20)},
             pre_dispatch=&amp;#39;2*n_jobs&amp;#39;, refit=True, return_train_score=False,
             scoring=None, verbose=0)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Results&quot;&gt;Results&lt;a class=&quot;anchor-link&quot; href=&quot;#Results&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We can see below that the best esimator works better for prediciton the validation set than the model above did.  Success!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[407,  27],
       [ 72, 185]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[108,   7],
       [ 23,  62]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Model-Minimizing&quot;&gt;Model Minimizing&lt;a class=&quot;anchor-link&quot; href=&quot;#Model-Minimizing&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Now that we have good results with a tuned model, we may want to simplify the model.  If we can simplify the model without significantly impacting accuracy, that's good for many reasons.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The model is easier to understand&lt;/li&gt;
&lt;li&gt;Fewer variables means fewer data quality issues and more focused data quality efforts&lt;/li&gt;
&lt;li&gt;It takes less resources and time to run&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Feature-Importance&quot;&gt;Feature Importance&lt;a class=&quot;anchor-link&quot; href=&quot;#Feature-Importance&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;There are many ways to measure importance.  How often do we use a feature to split?  How high up in the tree is it used to split?  We are going to use scikit learns feature importance information.&lt;/p&gt;
&lt;p&gt;Let's look at what features are!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rf_feat_importance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cols&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;imp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feature_importances_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                       &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;imp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ascending&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rf_feat_importance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;cols&lt;/th&gt;
      &lt;th&gt;imp&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;fare&lt;/td&gt;
      &lt;td&gt;0.216826&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;age&lt;/td&gt;
      &lt;td&gt;0.210577&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;adult_male&lt;/td&gt;
      &lt;td&gt;0.125894&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;sex&lt;/td&gt;
      &lt;td&gt;0.089614&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;who&lt;/td&gt;
      &lt;td&gt;0.082446&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Alright so we see that the most important variable is how much the passenger paid for their fare.  Lovely.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cols&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;imp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;barh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plot_fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Remove-Low-Important-Variables&quot;&gt;Remove Low Important Variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Remove-Low-Important-Variables&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;This isn't strictly neccesarry, but it is nice to simplify models if you can.  Simpler models are easier to understand and maintain, and they take less resources to run.  It is also interesting to know just how many variables are needed to predict.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_keep&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_keep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;6&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs_imp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_keep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_keep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_jobs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/home/isaacflath/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py:1978: FutureWarning: The default value of cv will change from 3 to 5 in version 0.22. Specify it explicitly to silence this warning.
  warnings.warn(CV_WARNING, FutureWarning)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;GridSearchCV(cv=&amp;#39;warn&amp;#39;, error_score=&amp;#39;raise-deprecating&amp;#39;,
             estimator=RandomForestClassifier(bootstrap=True, class_weight=None,
                                              criterion=&amp;#39;gini&amp;#39;, max_depth=None,
                                              max_features=&amp;#39;auto&amp;#39;,
                                              max_leaf_nodes=None,
                                              min_impurity_decrease=0.0,
                                              min_impurity_split=None,
                                              min_samples_leaf=1,
                                              min_samples_split=2,
                                              min_weight_fraction_leaf=0.0,
                                              n_estimators=&amp;#39;warn&amp;#39;, n_jobs=None,
                                              oob_score=False,
                                              random_state=None, verbose=0,
                                              warm_start=False),
             iid=&amp;#39;warn&amp;#39;, n_jobs=-1,
             param_grid={&amp;#39;max_depth&amp;#39;: range(10, 20, 20),
                         &amp;#39;max_features&amp;#39;: [&amp;#39;auto&amp;#39;, &amp;#39;log2&amp;#39;],
                         &amp;#39;min_samples_split&amp;#39;: range(2, 20),
                         &amp;#39;n_estimators&amp;#39;: range(10, 20, 20)},
             pre_dispatch=&amp;#39;2*n_jobs&amp;#39;, refit=True, return_train_score=False,
             scoring=None, verbose=0)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Results&quot;&gt;Results&lt;a class=&quot;anchor-link&quot; href=&quot;#Results&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we see with only 6 features we still get pretty good results on on validation set.&lt;/p&gt;
&lt;p&gt;Now the question is whether this small loss in accuracy outweighed by a simpler and more efficient model?  That is a business question more than it is a data science question.&lt;/p&gt;
&lt;p&gt;If you are detecting COVID-19, you probably want it to be as accurate as possible.  If you are going to predict whether someone is a cat or a dog person based on a survey for marketing purposes, small changes in accuracy probably are not as critical.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[390,  44],
       [ 59, 198]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[99, 16],
       [21, 64]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&amp;#39;gini&amp;#39;,
                       max_depth=10, max_features=&amp;#39;auto&amp;#39;, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=16,
                       min_weight_fraction_leaf=0.0, n_estimators=10,
                       n_jobs=None, oob_score=False, random_state=None,
                       verbose=0, warm_start=False)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Redundant-columns&quot;&gt;Redundant columns&lt;a class=&quot;anchor-link&quot; href=&quot;#Redundant-columns&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Of the 6 remaining variables, we can see that some of them are very related.  It makes sense to me that deck and fare are related.  Nicer areas probably cost more.  It makes sense to me that the person's sex has some redudancy with adult_male - the redundancy is even in the name.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cluster_columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;font_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;corr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scipy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stats&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spearmanr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;correlation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;corr_condensed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squareform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linkage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corr_condensed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;average&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dendrogram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orientation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leaf_font_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;font_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster_columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's experiment with removing some columns and see what we get.  We will use accuracy for our metric.&lt;/p&gt;
&lt;p&gt;Here is out baseline:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;accuracy: &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;\
    &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;\
    &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;accuracy: 
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.815&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bootstrap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gini&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;max_depth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_leaf_nodes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;min_impurity_decrease&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_impurity_split&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;min_samples_leaf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_samples_split&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;min_weight_fraction_leaf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_estimators&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;n_jobs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oob_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;warm_start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;\
    &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;\
    &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We will now loop through each of the remaining variables and train a model and print out the accuracy score.&lt;/p&gt;
&lt;p&gt;Judging by the scores below, removing any 1 variable does not significantly reduce the accuracy.  This means that we have redundant columns that can likely be trimmed.  Sex seems to be a column we would definitely keep as removing it have the most impact on accuracy.&lt;/p&gt;
&lt;p&gt;From this we can remove variables and iterate through to continue simplifying as much as possible.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sex&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;adult_male&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;who&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;deck&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fare&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variable&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;drop &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; accuracy:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;get_accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs_imp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;valid_xs_imp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;valid_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;drop sex accuracy:
0.815
drop adult_male accuracy:
0.825
drop who accuracy:
0.81
drop age accuracy:
0.855
drop deck accuracy:
0.835
drop fare accuracy:
0.825
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Elimination with Matrices (18.06_L2)</title><link href="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/10/18.06_2_EliminationWithMatrices.html" rel="alternate" type="text/html" title="Elimination with Matrices (18.06_L2)" /><published>2020-05-10T00:00:00-05:00</published><updated>2020-05-10T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/linear%20algebra/2020/05/10/18.06_2_EliminationWithMatrices</id><content type="html" xml:base="https://isaac-flath.github.io/blog/linear%20algebra/2020/05/10/18.06_2_EliminationWithMatrices.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-10-18.06_2_EliminationWithMatrices.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Motivation&quot;&gt;Motivation&lt;a class=&quot;anchor-link&quot; href=&quot;#Motivation&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;One of my goals is to understand more deeply what Neural Networks are doing.  Another is to have an easier time understanding and implementing cutting edge academic papers.  In order to work toward those goals, I am revisiting the Math behind Neural Networks.  This time my goal is to understand intuitively every piece of the material forward and backward - rather than to pass a course on a deadline.&lt;/p&gt;
&lt;p&gt;This blog post will be my notes about Lecture 2 from the following course:&lt;/p&gt;
&lt;p&gt;Gilbert Strang. 18.06 Linear Algebra. Spring 2010. Massachusetts Institute of Technology: MIT OpenCourseWare, &lt;a href=&quot;https://ocw.mit.edu&quot;&gt;https://ocw.mit.edu&lt;/a&gt;. License: Creative Commons BY-NC-SA.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Goal&quot;&gt;Goal&lt;a class=&quot;anchor-link&quot; href=&quot;#Goal&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The goal is to solve N equations with N unknowns, just like it was with lecture 1.  In the first Lecture it was about understanding how to solve them intuitively with linear combinations and matrix multiplication.  In reality, that is not a scalable choice when you get to higher and higher dimensions.  We need to be able to express these concepts in matrices and be more comfortable with that language and operations..&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Matrix-Form&quot;&gt;Matrix Form&lt;a class=&quot;anchor-link&quot; href=&quot;#Matrix-Form&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;As a recap, we can express a system of equations by listing the equations.  x&lt;/p&gt;
&lt;p&gt;$x+2y+z=2$&lt;/p&gt;
&lt;p&gt;$3x+8y+z=12$&lt;/p&gt;
&lt;p&gt;$4y+z=2$&lt;/p&gt;
&lt;p&gt;We can write the same thing in matrix form using the formula $Ax=b$.  The matrix A is from the system of equation above.&lt;/p&gt;
&lt;p&gt;$A = \begin{bmatrix}1&amp;amp;2&amp;amp;1\\3&amp;amp;8&amp;amp;1\\0&amp;amp;4&amp;amp;1\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Elimination&quot;&gt;Elimination&lt;a class=&quot;anchor-link&quot; href=&quot;#Elimination&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The general idea in elimination is to isolate variables so we can solve the equation.  For example, if we have 0x + 0y + 1z = 10, it is very easy to solve for z.  We can then plug it into another equation in the series that has z and 1 other unknown to get another value, and so on and so forth.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;$E_{21}$&quot;&gt;$E_{21}$&lt;a class=&quot;anchor-link&quot; href=&quot;#$E_{21}$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We are going to start by eliminating the first variable in the second row.  Row 2, column 1.  This would leave the second row with only 2 unknowns.&lt;/p&gt;
&lt;p&gt;The way we do this is we subtract row 1 from row 2.  If we substract 3 * 1 from 3, we get 0, so 3 will be the multiplier.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\-3&amp;amp;1&amp;amp;0\\0&amp;amp;0&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\3&amp;amp;8&amp;amp;1\\0&amp;amp;4&amp;amp;1\end{bmatrix}
=\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;4&amp;amp;1\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;$E_{31}$&quot;&gt;$E_{31}$&lt;a class=&quot;anchor-link&quot; href=&quot;#$E_{31}$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We then move on to row 3, column 1.  Lucky for us it's already 0 so we can skip this step&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;$E_{32}$&quot;&gt;$E_{32}$&lt;a class=&quot;anchor-link&quot; href=&quot;#$E_{32}$&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now move on to row 3, column 2.  If we can get this to 0, then we have 1 unknown in that column.  That's what we want as that's easily solvable.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\0&amp;amp;1&amp;amp;0\\0&amp;amp;-2&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;4&amp;amp;1\end{bmatrix}
=\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;0&amp;amp;5\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;How-can-this-fail?&quot;&gt;How can this fail?&lt;a class=&quot;anchor-link&quot; href=&quot;#How-can-this-fail?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A 0 cannot be in one of the pivot spots.  The pivot positions are the diagonals.  If that happens, elimination will fail.  If you think about it, a  0 being in the pivot spot means that the left side of the equation is 0.  Either the right side is also 0 and it gives you no information, or the right side is not 0 and there is no solution (ie 2 = 0 is False).&lt;/p&gt;
&lt;p&gt;Of course, there are some tricks that can be added to minimize failures.  The most common of these are row exchanges.  By swapping the order of the rows, you can potentially solve an equation that would have failed in the original order.&lt;/p&gt;
&lt;p&gt;For example, if I were to exchange the 2nd and 3rd rows I would multiply by the following matrix.&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\0&amp;amp;0&amp;amp;1\\0&amp;amp;1&amp;amp;0\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Back-Substitution&quot;&gt;Back Substitution&lt;a class=&quot;anchor-link&quot; href=&quot;#Back-Substitution&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Let's recap the steps that were taken.  We started with A and through elimination in 2 steps we ended with a new matrix.&lt;/p&gt;
&lt;p&gt;$A =&amp;gt; \begin{bmatrix}1&amp;amp;2&amp;amp;1\\3&amp;amp;8&amp;amp;1\\0&amp;amp;4&amp;amp;1\end{bmatrix} =&amp;gt; \begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;4&amp;amp;1\end{bmatrix} =&amp;gt; \begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;0&amp;amp;5\end{bmatrix} =&amp;gt; U$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Finish-the-Equation&quot;&gt;Finish the Equation&lt;a class=&quot;anchor-link&quot; href=&quot;#Finish-the-Equation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You may have realized these matrices represented the left side of the equation.  You may have wondered how we can modify the left side of the equation while leaving the right side alone?  The answer is that we cannot.  What is done on the left side must be applied to the right side.  Let's do that now.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We have done 2 transformations.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The first transformation was subtracting 3 of the first row from the second.&lt;/li&gt;
&lt;li&gt;The second transformation was subracting 2 of the second row from the third.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Let's do that to the the right side&lt;/p&gt;
&lt;p&gt;b =&amp;gt; $\begin{bmatrix}2\\12\\2\end{bmatrix} =&amp;gt; \begin{bmatrix}2\\6\\2\end{bmatrix} =&amp;gt;
\begin{bmatrix}2\\6\\-10\end{bmatrix} =&amp;gt; c$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's put the left and right side of the equations together to see what it looks like.&lt;/p&gt;
&lt;p&gt;$Ux = C$&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;0&amp;amp;5\end{bmatrix}\begin{bmatrix}x\\y\\z\end{bmatrix}=\begin{bmatrix}2\\6\\-10\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Final-Solution&quot;&gt;Final Solution&lt;a class=&quot;anchor-link&quot; href=&quot;#Final-Solution&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Intuitive-Solution&quot;&gt;Intuitive Solution&lt;a class=&quot;anchor-link&quot; href=&quot;#Intuitive-Solution&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Great!  Let's translate the $Ux=C$ matrix above back to our systems of equations view just to see if we can see how this transformation helps us.&lt;/p&gt;
&lt;p&gt;$x + 2y + z = 2$&lt;/p&gt;
&lt;p&gt;$2y - 2z = 6$&lt;/p&gt;
&lt;p&gt;$5z = -10$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;When we look at it here, we can solve them with some simple algebra starting from the bottom equation.&lt;/p&gt;
&lt;p&gt;$5z = -10 \;\;\;\mathbf{=&amp;gt;}\;\;\; z = -10/5 \;\;\;\mathbf{=&amp;gt;}\;\;\; z = -2$&lt;/p&gt;
&lt;p&gt;$2y - 2z = 6 \;\;\;\mathbf{=&amp;gt;}\;\;\; 2y - 2(-2) = 6 \;\;\;\mathbf{=&amp;gt;}\;\;\; 2y + 4 = 6 \;\;\;\mathbf{=&amp;gt;}\;\;\; 2y = 2 \;\;\;\mathbf{=&amp;gt;}\;\;\; y = 1$&lt;/p&gt;
&lt;p&gt;$x+2y+z=2 \;\;\;\mathbf{=&amp;gt;}\;\;\;x+2-2=2$$x+2y+z=2 \;\;\;\mathbf{=&amp;gt;}\;\;\;x=2$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Matrix-Solution&quot;&gt;Matrix Solution&lt;a class=&quot;anchor-link&quot; href=&quot;#Matrix-Solution&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;So first we should ask if we have an intuitive solution, why bother with doing the whole thing in matrix format?  Isn't it the same thing?&lt;/p&gt;
&lt;p&gt;And yes, we will be doing the same thing.  The reason is scalability and ability to transfer to N equation and N unknowns.  There's a limit to what can be done by hand, and matrix form allows for easier scalability.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Recap&quot;&gt;Recap&lt;a class=&quot;anchor-link&quot; href=&quot;#Recap&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We did several steps intuitively.  Let's recap our elimination steps from above&lt;/p&gt;
&lt;p&gt;$E_{21}$ step
$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\-3&amp;amp;1&amp;amp;0\\0&amp;amp;0&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\3&amp;amp;8&amp;amp;1\\0&amp;amp;4&amp;amp;1\end{bmatrix}
=\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;4&amp;amp;1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;$E_{32}$ step
$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\0&amp;amp;1&amp;amp;0\\0&amp;amp;-2&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;4&amp;amp;1\end{bmatrix}
=\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;0&amp;amp;5\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Simplify-into-1-step&quot;&gt;Simplify into 1 step&lt;a class=&quot;anchor-link&quot; href=&quot;#Simplify-into-1-step&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Great!  Now let's just combine these so we only have 1 equation.&lt;/p&gt;
&lt;p&gt;$E_{21}E_{32}A=U$
$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\0&amp;amp;1&amp;amp;0\\0&amp;amp;-2&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;0&amp;amp;0\\-3&amp;amp;1&amp;amp;0\\0&amp;amp;0&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\3&amp;amp;8&amp;amp;1\\0&amp;amp;4&amp;amp;1\end{bmatrix}=
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;0&amp;amp;5\end{bmatrix}
$&lt;/p&gt;
&lt;p&gt;Now let's simplify this by multiplying and combining my $E_{21}$ and $E_{31}$ matrices together.  We will call the result $E$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;$E_{21}E_{32}=E$
$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\0&amp;amp;1&amp;amp;0\\0&amp;amp;-2&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;0&amp;amp;0\\-3&amp;amp;1&amp;amp;0\\0&amp;amp;0&amp;amp;1\end{bmatrix} = 
\begin{bmatrix}1&amp;amp;0&amp;amp;0\\-3&amp;amp;1&amp;amp;0\\6&amp;amp;-2&amp;amp;1\end{bmatrix}$&lt;/p&gt;
&lt;p&gt;Great!  Now we can use this to simplify our formula.&lt;/p&gt;
&lt;p&gt;$EA=U$
$\begin{bmatrix}1&amp;amp;0&amp;amp;0\\-3&amp;amp;1&amp;amp;0\\6&amp;amp;-2&amp;amp;1\end{bmatrix}
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\3&amp;amp;8&amp;amp;1\\0&amp;amp;4&amp;amp;1\end{bmatrix}=
\begin{bmatrix}1&amp;amp;2&amp;amp;1\\0&amp;amp;2&amp;amp;-2\\0&amp;amp;0&amp;amp;5\end{bmatrix}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry><entry><title type="html">Descriptive Customer Analytics (Part 1)</title><link href="https://isaac-flath.github.io/blog/customer%20analytics/2020/05/10/Customer-Analytics-Part-1.html" rel="alternate" type="text/html" title="Descriptive Customer Analytics (Part 1)" /><published>2020-05-10T00:00:00-05:00</published><updated>2020-05-10T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/customer%20analytics/2020/05/10/Customer-Analytics-Part-1</id><content type="html" xml:base="https://isaac-flath.github.io/blog/customer%20analytics/2020/05/10/Customer-Analytics-Part-1.html">&lt;h1 id=&quot;intro&quot;&gt;Intro&lt;/h1&gt;

&lt;p&gt;Customer Analytics is a valuable tool, but often the basics are overlooked. It can have a huge impact, and it doesn’t always mean complex modeling.  It always starts with the basics.  Because customer analytics can make such a big impact, I am going to break this into several posts.&lt;/p&gt;

&lt;p&gt;In this post (Part 1) I am going to explain a basic descriptive customer analytics framework and how use it to identify the current state.  This understanding allows us to conduct A/B testing so we can measure how our actions impact revenue and by how much.  There are many ways to do this, this is just one of them.&lt;/p&gt;

&lt;p&gt;In Part 2 I’ll talk about how to build on the descriptive framework to create a predictive model.  A predictive model allows companies to plan proactively instead of reactively.&lt;/p&gt;

&lt;h1 id=&quot;background&quot;&gt;Background:&lt;/h1&gt;

&lt;p&gt;Many companies rely on experience and basic summarizing of historical statistics to make decisions.  While both of these are useful tools, a powerful way to successfully sustain long term revenue growth is to add customer analytics to their tool belt.  In this post I am discussing the starting point for analytics, descriptive analytics.&lt;/p&gt;

&lt;p&gt;An easy and solid starting point for descriptive analytics is a RFM (Recency, Frequency, Monetary Value) model.  A primary advantage to this is the only data you need is purchase history for each customer, which is information that almost every company tracks.  I’ve outlined the three main steps to creating this framework and using it to increase revenue.&lt;/p&gt;

&lt;h1 id=&quot;determine-length-of-customer-buying-cycle&quot;&gt;Determine length of customer buying cycle:&lt;/h1&gt;

&lt;p&gt;The first step is to determine what time range is a good time range to use for a buying cycle.  For a grocery store, maybe we say typically people go grocery shopping once a week.  In that scenario we would use 1 week as our time range for our cycle.  However a company that prints business cards may find a much longer time frame as customers tend to buy 1,000 and repurchase when they get low.  For this example we could use a 6 month cycle.  I encourage people to explore their data and pick a time range based on intuition.  There are better and more complicated ways to figure out this time range, but I encourage people to demonstrate results and revenue growth before circling back with more resources and support from executive management.&lt;/p&gt;

&lt;h1 id=&quot;calculate-descriptive-customer-metrics&quot;&gt;Calculate descriptive customer metrics:&lt;/h1&gt;

&lt;p&gt;Let’s say we choose a 1 month cycle.  The next step is to create and fill in a table to get frequency and monetary Value.  In the table below I outline how we calculate both of those KPIs (Key Performance Indicators).&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;January&lt;/th&gt;
      &lt;th&gt;February&lt;/th&gt;
      &lt;th&gt;March&lt;/th&gt;
      &lt;th&gt;Frequency&lt;/th&gt;
      &lt;th&gt;Monetary Value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Example&lt;/td&gt;
      &lt;td&gt;Rev&lt;/td&gt;
      &lt;td&gt;Rev&lt;/td&gt;
      &lt;td&gt;Rev&lt;/td&gt;
      &lt;td&gt;# of slots purchased in&lt;/td&gt;
      &lt;td&gt;Average Monetary Value&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer A&lt;/td&gt;
      &lt;td&gt;$102&lt;/td&gt;
      &lt;td&gt;$60&lt;/td&gt;
      &lt;td&gt;$75&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;=($102+$60+$75) / 3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer B&lt;/td&gt;
      &lt;td&gt;$97&lt;/td&gt;
      &lt;td&gt;$85&lt;/td&gt;
      &lt;td&gt;$0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;=($85+97) / 2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer C&lt;/td&gt;
      &lt;td&gt;$0&lt;/td&gt;
      &lt;td&gt;$9852&lt;/td&gt;
      &lt;td&gt;$0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;=($9,852) / 1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Once this is done add another column for Recency and fill that in with how long since that last purchase.  This can be days, hours, or seconds since last purchase depending on how far apart customer purchases typically are.  For this simplified version we will use days.  We end up with a table like this:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;Recency&lt;/th&gt;
      &lt;th&gt;Frequency&lt;/th&gt;
      &lt;th&gt;Monetary Value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer A&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;$79&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer B&lt;/td&gt;
      &lt;td&gt;35&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;$91&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Customer C&lt;/td&gt;
      &lt;td&gt;48&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;$9852&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;conduct-ab-testing&quot;&gt;Conduct A/B testing:&lt;/h1&gt;

&lt;p&gt;Now that we have three metrics (RFM) that describe customer buying patterns, we can start using them to run experiments to drive revenue growth.  A/B testing is a simple experiment that you can run to compare two things. You split your customers into two group and make no change to what you are doing to group A, but do something different in group B.  By doing this we can compare the revenue of the two groups to see what impact our efforts had.  If B is better, we will apply that action to the entire customer base.  If not, we scrap the idea and move on.  This is a never-ending process of  testing new ideas.&lt;/p&gt;

&lt;h1 id=&quot;heres-a-few-ideas-for-ab-tests-using-rfm-to-get-you-started&quot;&gt;Here’s a few ideas for A/B tests using RFM to get you started:&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;Call every customer in group B to see how that impacts revenue.  Does this increase Frequency (F) or average Monetary Value (M) of orders?  Is it worth the additional resources?&lt;/li&gt;
  &lt;li&gt;Send a marketing email blast to everyone in group B.  How does this change group B’s buying patterns?&lt;/li&gt;
  &lt;li&gt;What impact does sending a one-time-only 5\% off coupon have?&lt;/li&gt;
  &lt;li&gt;If we raise the price by 5\% in group B, what is the effect on revenue?  This is especially useful because we can run limited experiments and gauge reaction of price hikes without angering every customer.&lt;/li&gt;
  &lt;li&gt;If we raise the price on a product that is nearing the end of its product life cycle, do sales increase on the newly released product?  Does a price hike on old products encourage customers to buy newer versions?&lt;/li&gt;
  &lt;li&gt;Send group A customers to the current website and group B customers to a new website layout.  Monitor sales, traffic, and clicks on each site.  This can help determine the better layout.&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Intro</summary></entry><entry><title type="html">Gradient Descent for Linear Regression</title><link href="https://isaac-flath.github.io/blog/gradient%20descent/2020/05/09/GradientDescentforLinearRegression.html" rel="alternate" type="text/html" title="Gradient Descent for Linear Regression" /><published>2020-05-09T00:00:00-05:00</published><updated>2020-05-09T00:00:00-05:00</updated><id>https://isaac-flath.github.io/blog/gradient%20descent/2020/05/09/GradientDescentforLinearRegression</id><content type="html" xml:base="https://isaac-flath.github.io/blog/gradient%20descent/2020/05/09/GradientDescentforLinearRegression.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-09-GradientDescentforLinearRegression.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The goal of linear regression is to find parameter values that fit a linear function to data points.  The goodness of fit is measured by a cost function.  The lower the cost, the better the model.  Gradient Descent is a method to minimize a cost function.  Gradient descent is a widely used tool and is used frequently in tuning predictive models.  It’s important to understand the method so you can apply it to various models and are not limited to using black box models.&lt;/p&gt;
&lt;p&gt;As I just mentioned, gradient descent is a method to reduce a cost function.  To understand how to minimize a cost function, you need to understand how cost is calculated.  For this post I will be using a very simple example; linear regression with one feature, two data points, and two regression coefficients.  I will use the sum of squares cost function to take the predicted line and slowly change the regression coefficients until the line passes through both points.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/my_icons/gradientdescent-graph.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this example we could easily draw a line through the points without using gradient descent, but if we had more data points this would get trickier.  In the table below we can see what the data looks like that we are working with.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/my_icons/gradientdescent-table.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The tree below illustrates how to solve for cost as well as how to improve the values of $\theta$ to minimize cost.  In the illustration above, $J = a^1 + a^2$ is the cost function we want to minimize.  As we can see, if the regression coefficients ($\theta_0+\theta_1$) do not give a good fit, then the difference between our predicted values and observed values will be large and we will have a high cost ($J$).  For low values, we will have a low cost ($J$).  The figure below shows us how to calculate cost from the regression coefficients ($\theta_0$ and $\theta_1$).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/my_icons/gradient-descent-figure.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The second thing this chart shows you is how to improve values of theta.  We used the formulas in the boxes to evaluate $J$, so now we will use the values on the edges to improve the parameter values.  Each regression coefficient has a path up to the cost function.  You get a path value for each $\theta$ on the tree by multiplying the edge values along that path.  For example:&lt;/p&gt;
&lt;p&gt;$\theta_1\; path\;value = x^1 (y^1_{pred} - y^1_{obs}) (1) + x^2 (y^2_{pred} - y^2_{obs}) (1)$&lt;/p&gt;
&lt;p&gt;The last step is to improve the value of $\theta$.  In order to improve the value of $\theta$, we need to multiply the path value by $\alpha$, and subtract that from that $\theta$.  $\alpha$ is a value that determines how large the increments will be taken during optimization.  If you pick an $\alpha$ value that is is too large, you risk missing the local optima.  If you choose an $\alpha$ value that is too small you will be very accurate, but it will be more computationally expensive.
With more data points there would be more edges originating at $J$, and with more features there would be more thetas originating from the predicted values, but the same concept can be applied to these more complicated examples.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Isaac Flath</name></author><summary type="html"></summary></entry></feed>